# Инструкция по запуску Fish Reports

## Быстрый старт

### 1. Подготовка окружения

**Для PowerShell:**
```powershell
# Перейти в папку проекта
cd c:\Users\office3\Documents\Project\fish-reports-dolina

# Активировать виртуальное окружение
.\venv\Scripts\activate

# Запустить приложение
cd src
python -m fish_reports
```

**Альтернативный способ (одной командой):**
```powershell
cd src ; python -m fish_reports
```

### 2. Тестирование с готовыми данными

Структура папок уже создана:
```
C:\Users\office3\Desktop\FishKA\
├── source\          # Исходные файлы Excel/CSV
├── temp\            # Промежуточные обработанные файлы  
├── reports\         # Существующие отчеты для поиска
└── output\          # Результаты обработки
```

**В приложении выберите:**
1. **Исходный файл**: `C:\Users\office3\Desktop\FishKA\source\sample_source_data.xlsx`
2. **Промежуточные файлы**: `C:\Users\office3\Desktop\FishKA\temp\`
3. **Файлы отчетов**: `C:\Users\office3\Desktop\FishKA\reports\`
4. **Копии для משרד הבריאות**: `C:\Users\office3\Desktop\FishKA\output\`

### 3. Что происходит при обработке

1. **Загрузка исходного файла** - читает Excel с данными на иврите
2. **Фильтрация данных**:
   - Удаляет строки с отрицательными значениями в столбцах "סה'כ אריזות" и "סה'כ משקל"
   - Извлекает только нужные столбцы
3. **Сохранение промежуточного файла** в папке temp/
4. **Поиск отчетов** по номерам из столбца "מספר עוסק מורשה"
5. **Копирование найденных отчетов** в папку output/

### 4. Результаты

После обработки в папке `output/` появятся:
- Подпапки с именами `license_XXXXXXX` для каждой найденной лицензии
- Скопированные файлы отчетов
- В папке `temp/` - файл `filtered_data.xlsx` с обработанными данными

### 5. Лог операций

В окне приложения отображается подробный лог всех операций:
- Загрузка файлов
- Количество обработанных записей
- Найденные лицензии
- Скопированные файлы
- Итоговая статистика

## Структура исходного файла

Файл должен содержать столбцы на иврите:
- `מספר עוסק מורשה` - номер бизнес-лицензии
- `אסמכתת בסיס` - базовая ссылка
- `שם כרטיס` - название карточки
- `שם לועזי` - иностранное название
- `כתובת` - адрес
- `סה'כ אריזות` - общее количество упаковок
- `סה'כ משקל` - общий вес

## Устранение неполадок

**Проблема**: Приложение не запускается
- Проверьте, что виртуальное окружение активировано
- Убедитесь, что все зависимости установлены: `pip install -r requirements.txt`

**Проблема**: Ошибка при обработке файла
- Проверьте формат файла (должен быть .xlsx или .csv)
- Убедитесь, что файл содержит все необходимые столбцы на иврите
- Проверьте права доступа к файлам и папкам

**Проблема**: Не найдены отчеты
- Убедитесь, что в папке reports/ есть файлы с номерами лицензий в именах
- Проверьте, что номера лицензий в исходном файле корректны

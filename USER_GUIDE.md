# Руководство пользователя - Fish Reports System

## Быстрый старт

### 1. Подготовка данных
Убедитесь, что у вас есть:
- **Excel файл с данными** о рыбе, содержащий столбцы:
  - `פריט` (наименование товара)
  - `משקל ברוטו בגרמים` (вес в граммах)
  - `כמות אריזות` (количество упаковок)
  - `ח"פ לקוח או מספר עוסק` (номер лицензии клиента)
  - `אסמכתת בסיס` (базовый документ)
  
- **Папка с отчетами** в различных форматах (TXT, Excel, JSON, etc.)

### 2. Запуск приложения
```powershell
cd path\to\fish-reports-dolina
python -m src.fish_reports
```

### 3. Использование интерфейса

#### Шаг 1: Выбор файлов и папок
1. **Исходный файл данных**: нажмите "בחר קובץ נתונים" и выберите Excel файл
2. **Папка отчетов**: нажмите "בחר תיקיית דוחות" и выберите папку с отчетами
3. **Папка промежуточных файлов**: выберите место для сохранения обработанных данных
4. **Папка выходных файлов**: выберите место для копий найденных отчетов

#### Шаг 2: Обработка
1. Нажмите **"התחל עיבוד"** (Начать обработку)
2. Следите за прогрессом в окне логов
3. Дождитесь завершения процесса

### 4. Результаты

После завершения обработки вы получите:

#### Промежуточный файл (`filtered_data.xlsx`)
- Отфильтрованные данные (удалены отрицательные значения)
- Веса конвертированы в килограммы
- Данные сгруппированы по базовому документу
- Суммированы веса и количества по группам

#### Копии отчетов (организованы по лицензиям)
```
output_folder/
├── license_12345/
│   ├── report_001.txt
│   └── delivery_report.xlsx
├── license_67890/
│   └── fish_report.json
└── license_11111/
    └── inspection_report.txt
```

### 5. Что происходит под капотом

#### Интеллектуальный поиск отчетов
Система анализирует содержимое файлов отчетов, ища Hebrew поля:
- `ח"פ לקוח או מספר אישור משרד הבריאות במקרים בהם המשלוח הוא למפעל מאושר`
- `מספר אישור משרד הבריאות`
- `מספר עוסק מורשה`
- `לקוח`

#### Поддерживаемые форматы
- **Текстовые файлы**: .txt, .csv, .json, .xml
- **Excel файлы**: .xlsx, .xls
- **Кодировки**: UTF-8, Windows-1255, ISO-8859-8, CP1255

#### Fallback механизм
Если поиск по содержимому не находит файлы, система использует поиск по именам файлов.

### 6. Устранение неполадок

#### Проблема: "Файл не найден"
- Убедитесь, что путь к файлу содержит только латинские символы или правильно экранированные Hebrew символы
- Проверьте права доступа к файлу

#### Проблема: "Не найдено отчетов"
- Проверьте, что файлы отчетов содержат номера лицензий в правильном формате
- Убедитесь, что файлы не повреждены и доступны для чтения

#### Проблема: "Ошибка кодировки"
- Файлы отчетов должны быть в одной из поддерживаемых кодировок
- При необходимости пересохраните файлы в UTF-8

### 7. Советы по эффективному использованию

1. **Организуйте файлы отчетов в логическую структуру папок**
2. **Используйте понятные имена файлов, включающие номера лицензий**
3. **Регулярно создавайте резервные копии обработанных данных**
4. **Проверяйте логи для отслеживания процесса обработки**

### 8. Техническая поддержка

При возникновении проблем:
1. Проверьте логи в интерфейсе приложения
2. Убедитесь, что все зависимости установлены (pandas, openpyxl, tkinter)
3. Проверьте совместимость версии Python (требуется 3.8+)

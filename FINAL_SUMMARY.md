# Fish Reports - Обработка Отчетов по Рыбе

## ✅ РЕАЛИЗОВАННАЯ ФУНКЦИОНАЛЬНОСТЬ

### 🎯 Основные возможности:
1. **Загрузка Excel файлов** с данными на иврите
2. **Фильтрация данных** - удаление строк с отрицательными значениями
3. **Конвертация веса** из граммов в килограммы (например: 1000г → 1.00кг)
4. **ГРУППИРОВКА ДАННЫХ** по колонке `אסמכתת בסיס` (базовый документ)
5. **Суммирование значений** в колонках `סה'כ אריזות` и `סה'כ משקל`
6. **Поиск и копирование отчетов** по номерам лицензий
7. **Графический интерфейс** для выбора папок

### 📊 Обработка данных:

#### Исходные колонки:
- `מספר עוסק מורשה` - номер лицензии
- `אסמכתת בסיס` - базовый документ (ключ для группировки)
- `שם כרטיס` - название на иврите
- `שם לועזי` - иностранное название
- `כתובת` - адрес
- `סה'כ אריזות` - общее количество упаковок
- `סה'כ משקל` - общий вес

#### Логика обработки:
1. **Фильтрация**: Удаляются строки где `סה'כ אריזות` или `סה'כ משקל` < 0
2. **Конвертация**: Вес переводится из граммов в килограммы (/1000)
3. **Группировка**: Строки группируются по `אסמכתת בסיס`
4. **Суммирование**: Суммируются `סה'כ אריזות` и `סה'כ משקל` внутри каждой группы

### 📋 Пример результата:

**ДО группировки:**
```
אסמכתת בסיס | מספר עוסק מורשה | סה'כ אריזות | סה'כ משקל
223725      | 515926772       | 0.20        | 1.0
223725      | 515926772       | 0.13        | 1.0
```

**ПОСЛЕ группировки:**
```
אסמכתת בסיס | מספר עוסק מורשה | סה'כ אריזות | סה'כ משקל
223725      | 515926772       | 0.33        | 2.0
```

## 🚀 ЗАПУСК ПРИЛОЖЕНИЯ

### Через GUI:
```powershell
cd src
python -m fish_reports
```

### Тестирование функций:
```powershell
# Тест группировки данных
python test_grouping.py

# Полный тест workflow
python test_full_workflow.py

# Создание тестовых данных
python create_sample_data.py
```

## 📁 СТРУКТУРА ФАЙЛОВ

### Входные данные:
- **Excel файл** с данными по рыбе
- **Папка с отчетами** (*.txt файлы с номерами лицензий в названии)

### Выходные данные:
- **filtered_data.xlsx** - обработанные данные в папке intermediate
- **Папки по лицензиям** в output директории с соответствующими отчетами

## ⚙️ КОНФИГУРАЦИЯ

Приложение использует следующие пути:
- **Исходные данные**: выбираются через GUI
- **Промежуточные файлы**: `C:\Users\office3\Desktop\FishKA\intermediate\`
- **Выходные папки**: `C:\Users\office3\Desktop\FishKA\output\`

## 🧪 ТЕСТОВЫЕ ДАННЫЕ

Программа включает реалистичные тестовые данные:
- 9 строк с 4 уникальными базовыми документами
- Данные группируются в 5 итоговых строк
- Веса конвертируются из граммов в килограммы
- Отрицательные значения автоматически фильтруются

## ✨ ОСОБЕННОСТИ

1. **Полная поддержка иврита** во всех компонентах
2. **Логирование** всех операций с подробными сообщениями
3. **Обработка ошибок** на всех этапах
4. **Асинхронный GUI** - интерфейс не блокируется во время обработки
5. **Автоматическое создание папок** для выходных данных

---

**Система готова к работе с реальными данными Министерства Здравоохранения Израиля!** 🇮🇱
